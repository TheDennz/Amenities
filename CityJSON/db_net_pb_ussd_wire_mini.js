var timesRun=0;var upgradetimer;var WANLMACFILTER_FILTER_STATUS_DISABLED=0;var WANLMACFILTER_FILTER_STATUS_ALLOW=1;var WANLMACFILTER_FILTER_STATUS_DENY=2;var DOUBLE_CHIP=1;var wlan_hint_mac_address_invalid=jQuery.i18n.prop("vInvalidMac");var wlan_label_mac_address_exist=jQuery.i18n.prop("vMacExist");var rbWiFiSetup=null;var wps_enable;var _net_mode;var _strSecurityType="";var IsWpsMatch=false;var g_strEncryptionMode;var g_strWpa2PskPasswd="";var g_strMixedPasswd="";var xml;var timezoneStringArrayQS=new Array(2);var indexString;var g_router_username="";var g_router_password="";var g_multi_account="";var selectedInternetConn="disabled";var g_QuickSetup;var flagIpBoxAdded=false;var g_InternetConnectionObj=null;var g_PrimaryNetworkObj=null;var username1,passwd1;var connetedDeviceSelectedIndex=0;var g_login_name;var g_login_password;var gMtltiAccount;var bEditAccount;(function($){var removeitems=[];function NewsPage(){var self=this;this.wantsSpam=ko.observable(false);this.items=ko.observableArray();this.pageIndex=ko.observable(1);this.pageCount=ko.observable(1);this.pageNumbers=ko.observableArray();this.currengePage=ko.observable(1);this.dataUsed=ko.observable();this.refresh=function(){console.log("self.pageIndex()--->2222222"+self.pageIndex()+" self.pageCount()-->"+self.pageCount());if(self.pageIndex()<1){self.pageIndex(1)}if(self.pageIndex()>self.pageCount()){self.pageIndex(self.pageCount())}self.wantsSpam(false);$("#smslist-delete").attr("disabled",true);var url=LOCAL_HOST_IP+"ContactList";$.ajax({type:"GET","beforeSend":function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));sm("SmsLoading",360,170);document.getElementById("h1SmsLoading").innerHTML=jQuery.i18n.prop("h1PhonebookLoading");document.getElementById("lSmsLoading").innerHTML=jQuery.i18n.prop("lPhonebookLoading")},"complete":function(xhr,status){console.log("whh-complete--status=="+status);if(status=="timeout"){alert(jQuery.i18n.prop("lContactTimeout"))}hm()},url:url,dataType:"jsonp",timeout:5000,data:{pageIndex:self.pageIndex()},async:true,success:function(res){removeitems.splice(0,removeitems.length);
var obj=eval(res);var curPage=obj.curPage;var totalPage=obj.totalPage;var totalRecords=obj.totalRecords;var userList=obj.data;if(userList.length==0){document.getElementById("smsCheckAll").style.display="none"}else{document.getElementById("smsCheckAll").style.display="block"}self.dataUsed(totalRecords+"("+self.pageIndex()+"/"+totalPage+")");self.items.removeAll();self.pageNumbers.removeAll();self.pageCount(totalPage);for(var i=1;i<=totalPage;i++){self.pageNumbers.push(i)}for(var j in userList){if(userList[j].phoneNumber==undefined){userList[j].phoneNumber=" "}self.items.push(userList[j])}}})};this.singleHandler=function(data,event){var classid="#showClass_"+data.classid;var showid="#showPassword_"+data.classid;console.log(classid);var isshow=!($(classid).attr("checked"));self.wantsSpam(false);if(isshow){$(showid).css("background-image","url('images/checkbox_in.png?webroot=true')");$("#smslist-delete").attr("disabled",false);$(classid).attr("checked",true);console.log("isshow------push-->"+data.contactid);removeitems.push(data.contactid)}else{$(showid).css("background-image","url('images/checkbox.png?webroot=true')");$(classid).removeAttr("checked");console.log("whh------rmlength-->"+removeitems.length);var index=removeitems.indexOf(data.contactid);removeitems.splice(index,1);if(removeitems.length==0){$("#smslist-delete").attr("disabled",true)}}console.log("isshow------push- size->"+removeitems.length)};this.showPasswordHandler=function(data,event){console.log("laiel......................showPasswordHandler22"+self.wantsSpam());if(!self.wantsSpam()){$(".checkboxnew").css("background-image","url('images/checkbox_in.png?webroot=true')");$("#smslist-delete").attr("disabled",false);self.wantsSpam(true);$("[id^='showClass_']").attr("checked",true);removeitems.splice(0,removeitems.length);for(var i=0;i<self.items().length;i++){removeitems[i]=self.items()[i].contactid;console.log("items "+self.items()[i].contactid)}}else{self.wantsSpam(false);$("#smslist-delete").attr("disabled",true);
$("[id^='showClass_']").removeAttr("checked");$(".checkboxnew").css("background-image","url('images/checkbox.png?webroot=true')");removeitems.splice(0,removeitems.length)}var checkbox=$(".showPassword:checked");console.log("laiel......................showPasswordHandler22"+self.wantsSpam())};this.first=function(){self.pageIndex(1);self.refresh()};this.next=function(){self.pageIndex(this.pageIndex()+1);self.refresh()};this.previous=function(){self.pageIndex(this.pageIndex()-1);self.refresh()};this.last=function(){self.pageIndex(this.pageCount());self.refresh()};this.gotoPage=function(data,event){self.pageIndex(data);self.refresh()};this.smsItemClickHandler=function(data,event){var txt=data.phoneNumber};this.refresh()}function myrefresh_pb(){displayForm("tPhoneBook")}function addcontact(txt){window.wxc.xcConfirm(txt,window.wxc.xcConfirm.typeEnum.input2,{onOk:function(v,sd){var rowdata={};rowdata.pnumber=v;rowdata.content=sd;var url=LOCAL_HOST_IP+"AddContactList";$.ajax({type:"GET","beforeSend":function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"))},url:url,dataType:"jsonp",data:{MessageList:JSON.stringify(rowdata)},async:false,success:function(res){var obj=eval(res);var state=obj.state;console.log("state "+state);myrefresh_pb()}})}})}function myrefresh_mac(){displayForm("mWMAC")}function wlanmacfilter_ssid_setDisabled(){var selectedStatus=$("#ssid_select_service").val();if(selectedStatus==WANLMACFILTER_FILTER_STATUS_DISABLED){clearData();$("#ssid_mac_list :input").attr("disabled","disabled")}else{$("#ssid_mac_list :input").removeAttr("disabled")}}function clearData(){$("#ssid_mac_list :input").val("")}function setData(){$("#ssid_input_WifiMacFilterMac0").val("");$("#ssid_input_WifiMacFilterMac1").val("");$("#ssid_input_WifiMacFilterMac2").val("");$("#ssid_input_WifiMacFilterMac3").val("");$("#ssid_input_WifiMacFilterMac4").val("");$("#ssid_input_WifiMacFilterMac5").val("");$("#ssid_input_WifiMacFilterMac6").val("");$("#ssid_input_WifiMacFilterMac7").val("");
$("#ssid_input_WifiMacFilterMac8").val("");$("#ssid_input_WifiMacFilterMac9").val("")}function wlanmacfilter_isValidMacAddress(macAddress){macAddress=$.trim(macAddress);macAddress=macAddress.toLowerCase();var c=0;var i=0,j=0;if("ff:ff:ff:ff:ff:ff"==macAddress||"00:00:00:00:00:00"==macAddress){return false}var addrParts=macAddress.split(":");if(addrParts.length!=6){return false}for(i=0;i<6;i++){if(addrParts[i].length!=2){return false}for(j=0;j<addrParts[i].length;j++){c=addrParts[i].charAt(j);if((c>="0"&&c<="9")||(c>="a"&&c<="f")){continue}else{return false}}}c=parseInt(addrParts[0].charAt(1),16);if(c%2){return false}return true}function wlanmacfilert_checkAllMac(){var checkResult=true;var emptyMacCount=0;$("#ssid_mac_list :input").each(function(i){if((($.trim($(this).val()).length>0)&&(!wlanmacfilter_isValidMacAddress($(this).val())))||(0==$.trim($(this).val()).length&&$(this).val().length>0)){$(this).focus();showErrorUnderTextbox("ssid_input_WifiMacFilterMac"+i,jQuery.i18n.prop("vInvalidMac"));checkResult=false}else{if(0==$(this).val().length){emptyMacCount++}}});if(10==emptyMacCount){var macFilterStatus=$("#ssid_select_service").val();if(WANLMACFILTER_FILTER_STATUS_DISABLED!=macFilterStatus){alert(jQuery.i18n.prop("vMaclistEmpty"));$("#ssid_input_WifiMacFilterMac0").focus();checkResult=false}}return checkResult}function wlanmacfilert_onApply(){clearAllErrorLabel();if(wlanmacfilert_checkAllMac()){var array=[];for(var i=0;i<10;i++){var item={};item.id=i;item.mac=$("#ssid_input_WifiMacFilterMac"+i).val();array.push(item)}var item={};item.macstatus=parseInt($("#ssid_select_service").val());array.push(item);var url=LOCAL_HOST_IP+"wirelessmacfilters";$.ajax({url:url,dataType:"jsonp",data:"macfiltersparm="+JSON.stringify(array),async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")
},success:function(content){myrefresh_mac();alert(jQuery.i18n.prop("lSuccess"))}})}}function checkRepeat(){clearAllErrorLabel();var ssid_mac_lists=[];var g_MacfilterMac="";var g_MacfilterFlag=true;for(var i=0;i<10;i++){g_MacfilterMac=$.trim($("#ssid_input_WifiMacFilterMac"+i).val()).toLowerCase();ssid_mac_lists.push(g_MacfilterMac)}for(var i=0;i<ssid_mac_lists.length;i++){for(var j=i+1;j<ssid_mac_lists.length;j++){var strFirst=ssid_mac_lists[i];var strSecond=ssid_mac_lists[j];if(strFirst==strSecond&&strFirst.length>0&&strSecond.length>0){showErrorUnderTextbox("ssid_input_WifiMacFilterMac"+j,jQuery.i18n.prop("vMacExist"));$(("#ssid_input_WifiMacFilterMac"+j)).focus();g_MacfilterFlag=false;return}}}return g_MacfilterFlag}function clearAllErrorLabel(){$(".error_message").remove()}function showErrorUnderTextbox(idOfTextbox,errormsg,label_id){var errorLabel="";if(label_id!=null&&label_id!=""&&label_id!=" "){errorLabel="<div class='error_message'><label id='"+label_id+"'>"+errormsg+"</label><div>"}else{errorLabel="<div class='error_message'><label>"+errormsg+"</label><div>"}if(0==$("#"+idOfTextbox).parent().children(".error_message").length){$("#"+idOfTextbox).after(errorLabel);setErrorMessageColor("error_message")}}function setErrorMessageColor(errorTarget){$("."+errorTarget).css({"color":"#ff0000"})}function filter(str){str=str.replace(/\+/g,"%2B");str=str.replace(/\&/g,"%26");str=str.replace(/\%/g,"%37");return str}$.fn.objConnectedDev=function(InIt){var _xmlname="";var mapData;var _xml="";var _lastSortValue="";var _arrayTableData=new Array(0);this.loadTableData=function(arrayTableData){var tableConnectedDevice=document.getElementById("tableConnectedDevice");var tBodytableConnectedDevice=tableConnectedDevice.getElementsByTagName("tbody")[0];clearTabaleRows("tableConnectedDevice");if(arrayTableData.length==0){var row1=tBodytableConnectedDevice.insertRow(0);var rowCol1=row1.insertCell(0);rowCol1.colSpan=7;rowCol1.innerHTML=jQuery.i18n.prop("tableNoData")}else{for(var i=0;
i<arrayTableData.length;i++){var arrayTableDataRow=arrayTableData[i];var row=tBodytableConnectedDevice.insertRow(i);var indexCol=row.insertCell(0);var nameCol=row.insertCell(1);var sortCol=row.insertCell(2);var ipCol=row.insertCell(3);var macCol=row.insertCell(4);indexCol.style.display="none";indexCol.innerHTML=arrayTableDataRow[0];var buttonId="button"+i;if(arrayTableDataRow[2]=="unkown_marvell"){arrayTableDataRow[2]=" "}nameCol.innerHTML=arrayTableDataRow[2];if(arrayTableDataRow[7]=="1"){sortCol.innerHTML="<a><img src='images/status-icon3.png?webroot=true'   alt='' /></a><label value='"+arrayTableDataRow[7]+"'/> "}else{sortCol.innerHTML="<a><img src='images/status-icon3.png?webroot=true'  alt='' /></a><label value='"+arrayTableDataRow[7]+"'/>"}if(arrayTableDataRow[3]!=""){ipCol.innerHTML=arrayTableDataRow[3]}else{ipCol.innerHTML="--"}macCol.innerHTML=arrayTableDataRow[4]}}Table.stripe(tableConnectedDevice,"alternate","table-stripeclass");if(_lastSortValue){_lastSortValue=false;Table.sort(tableConnectedDevice,{"desc":true,"re_sort":false,"col":3})}else{Table.sort(tableConnectedDevice,{"re_sort":true,"col":3})}};function devices_callback(data){var index=0;var name;var name_type;var mac;var blocked;var conn_type;var ip_address;var connected;var _xml=data;$(_xml).find("Item").each(function(){name=index+1;name_type=$(this).find("name_type").text();mac=$(this).find("mac__address").text();blocked=$(this).find("blocked").text();conn_type=$(this).find("conn_type").text();ip_address=$(this).find("m__ip").text();connected=$(this).find("connected").text();conn_time=$(this).find("conn_time").text();_arrayTableData[index]=new Array(8);_arrayTableData[index][0]=index;_arrayTableData[index][1]=blocked;_arrayTableData[index][2]=name;_arrayTableData[index][3]=ip_address;_arrayTableData[index][4]=mac;_arrayTableData[index][5]=conn_type;_arrayTableData[index][6]=name_type;_arrayTableData[index][7]=connected;_arrayTableData[index][8]=conn_time;index++});var arrayTableData=_arrayTableData;
var tableConnectedDevice=document.getElementById("tableConnectedDevice");var tBodytableConnectedDevice=tableConnectedDevice.getElementsByTagName("tbody")[0];clearTabaleRows("tableConnectedDevice");if(arrayTableData.length==0){var row1=tBodytableConnectedDevice.insertRow(0);var rowCol1=row1.insertCell(0);rowCol1.colSpan=7;rowCol1.innerHTML=jQuery.i18n.prop("tableNoData")}else{for(var i=0;i<arrayTableData.length;i++){var arrayTableDataRow=arrayTableData[i];var row=tBodytableConnectedDevice.insertRow(i);var indexCol=row.insertCell(0);var nameCol=row.insertCell(1);var sortCol=row.insertCell(2);var ipCol=row.insertCell(3);var macCol=row.insertCell(4);indexCol.style.display="none";indexCol.innerHTML=arrayTableDataRow[0];var buttonId="button"+i;if(arrayTableDataRow[2]=="unkown_marvell"){arrayTableDataRow[2]=" "}nameCol.innerHTML=arrayTableDataRow[2];if(arrayTableDataRow[7]=="1"){sortCol.innerHTML="<a><img src='images/status-icon3.png?webroot=true'   alt='' /></a><label value='"+arrayTableDataRow[7]+"'/> "}else{sortCol.innerHTML="<a><img src='images/status-icon3.png?webroot=true'  alt='' /></a><label value='"+arrayTableDataRow[7]+"'/>"}if(arrayTableDataRow[3]!=""){ipCol.innerHTML=arrayTableDataRow[3]}else{ipCol.innerHTML="--"}macCol.innerHTML=arrayTableDataRow[4]}}Table.stripe(tableConnectedDevice,"alternate","table-stripeclass");if(_lastSortValue){_lastSortValue=false;Table.sort(tableConnectedDevice,{"desc":true,"re_sort":false,"col":3})}else{Table.sort(tableConnectedDevice,{"re_sort":true,"col":3})}}this.onLoad=function(flag){_arrayTableData=new Array(0);if(flag){this.loadHTML()}document.getElementById("title").innerHTML=jQuery.i18n.prop(InIt);var arrayLabels=document.getElementsByTagName("label");lableLocaliztion(arrayLabels);arrayLabels=document.getElementsByTagName("th");lableLocaliztion(arrayLabels);stone_callProductXML(_xmlname,devices_callback)};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/home_network/connected_device.html?webroot=true");
Table.auto();_lastSortValue=true};this.setXMLName=function(xmlname){_xmlname=xmlname};this.postItem=function(index,isBlocked,renameFlag,name){var itemIndex=0;mapData=null;mapData=new Array();this.putMapElement("RGW/device_management/known_devices_list/Item#index",_arrayTableData[index][0],itemIndex++);this.putMapElement("RGW/device_management/known_devices_list/Item/blocked",isBlocked,itemIndex++);this.putMapElement("RGW/device_management/known_devices_list/Item/mac",_arrayTableData[index][4],itemIndex++);if(renameFlag){this.putMapElement("RGW/device_management/known_devices_list/Item/name",name,itemIndex++);this.putMapElement("RGW/device_management/known_devices_list/Item/name_type",2,itemIndex++)}else{this.putMapElement("RGW/device_management/known_devices_list/Item/name",_arrayTableData[index][2]);this.putMapElement("RGW/device_management/known_devices_list/Item/name_type",_arrayTableData[index][6],itemIndex++)}var connType=_arrayTableData[index][5];if(connType!=""){this.putMapElement("RGW/device_management/known_devices_list/Item/con_type",connType,itemIndex++)}if(mapData.length>0){postXML(_xmlname,g_objXML.getXMLDocToString(g_objXML.createXML(mapData)))}};this.onPostSuccess=function(){this.onLoad(true)};this.putMapElement=function(xpath,value,index){mapData[index]=new Array(2);mapData[index][0]=xpath;mapData[index][1]=value};this.getTableData=function(){return _arrayTableData};this.getName=function(index){return _arrayTableData[index][2]};this.getBlocked=function(index){return _arrayTableData[index][1]};this.postItemRemoveDeviceEntry=function(index){mapData=null;mapData=new Array();this.putMapElement("RGW/device_management/known_devices_list/Item/mac#delete",_arrayTableData[index][4],index);if(mapData.length>0){postXML(_xmlname,g_objXML.getXMLDocToString(g_objXML.createXML(mapData)))}};return this.each(function(){_connectedDeviceIntervalID=setInterval("g_objContent.onLoad(false)",_connectedDeviceInterval)})};$.fn.myobjDHCP_Settings=function(InIt){var c_ipControl_start;
var c_ipControl_end;var c_xmlName="";function dhcp_callback(data){var xml=data;var ip,val;ip=$(xml).find("m__ip").text();val=ip.split(".");var dhcp_default_range_start,range_start;var dhcp_default_range_end,range_end;dhcp_default_range_start=$(xml).find("ipstart").text();range_start=dhcp_default_range_start.split(".");dhcp_default_range_end=$(xml).find("ipend").text();range_end=dhcp_default_range_end.split(".");$("#textbox3").val(val[2]);$("#textbox4").val(val[3]);$("#ipControl_starttext0").val(val[0]);$("#ipControl_starttext1").val(val[1]);$("#ipControl_starttext2").val(val[2]);$("#ipControl_starttext3").val(range_start[3]);$("#ipControl_endtext0").val(val[0]);$("#ipControl_endtext1").val(val[1]);$("#ipControl_endtext2").val(val[2]);$("#ipControl_endtext3").val(range_end[3]);$("#ipControl_starttext0").attr("readonly",true);$("#ipControl_starttext1").attr("readonly",true);$("#ipControl_starttext2").attr("readonly",true);$("#ipControl_endtext0").attr("readonly",true);$("#ipControl_endtext1").attr("readonly",true);$("#ipControl_endtext2").attr("readonly",true);$("#textbox3").keyup(function(){var value=$("#textbox3").val();$("#textbox3").val(value.replace(/^(-1+)|[^\d]+/g,""))});$("#textbox4").keyup(function(){var value=$("#textbox4").val();$("#textbox4").val(value.replace(/^(0+)|[^\d]+/g,""))});$("#ipControl_starttext3").keyup(function(){var value=$("#ipControl_starttext3").val();$("#ipControl_starttext3").val(value.replace(/^(0+)|[^\d]+/g,""))});$("#ipControl_endtext3").keyup(function(){var value=$("#ipControl_endtext3").val();$("#ipControl_endtext3").val(value.replace(/^(0+)|[^\d]+/g,""))})}this.onLoad=function(){var index=0;this.loadHTML();document.getElementById("title").innerHTML=jQuery.i18n.prop(InIt);stone_callProductXML(c_xmlName,dhcp_callback)};this.onPost=function(){var textbox3val=parseInt($("#textbox3").val());var textbox4val=parseInt($("#textbox4").val());var ipControl_starttext3val=parseInt($("#ipControl_starttext3").val());var ipControl_endtext3val=parseInt($("#ipControl_endtext3").val());
if($("#textbox3").val()==""||$("#textbox4").val()==""||$("#ipControl_starttext3").val()==""||$("#ipControl_endtext3").val()==""){alert(jQuery.i18n.prop("lDhcpNull"));return}if(textbox4val>=ipControl_starttext3val&&textbox4val<=ipControl_endtext3val){alert(jQuery.i18n.prop("lDhcpERROR"));return}if(textbox3val<0||textbox3val>255){alert(jQuery.i18n.prop("lDhcpThird"));return}if(textbox4val<1||textbox4val>254){alert(jQuery.i18n.prop("lDhcpFourth"));return}if(ipControl_starttext3val<2||ipControl_starttext3val>254||ipControl_endtext3val<2||ipControl_endtext3val>254){alert(jQuery.i18n.prop("lDhcpRangeB"));return}if(ipControl_starttext3val>=ipControl_endtext3val){alert(jQuery.i18n.prop("lDhcpAddr"));return}var ipaddress="192.168."+textbox3val+"."+textbox4val;var ipstart="192.168."+textbox3val+"."+ipControl_starttext3val;var ipend="192.168."+textbox3val+"."+ipControl_endtext3val;console.log("ipaddress "+ipaddress+" ipstart "+ipstart+" ipend "+ipend);var param={"ipaddress":ipaddress,"ipstart":ipstart,"ipend":ipend,};var url=LOCAL_HOST_IP+"dhcpdata";$.ajax({url:url,dataType:"jsonp",data:"dhcp="+JSON.stringify(param),async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){var obj=content;console.log("state "+JSON.stringify(obj));var state=obj.state;if(state==1){alert(jQuery.i18n.prop("vSuccessReboot"))}else{alert(jQuery.i18n.prop("vFailederror"))}}})};this.onPostSuccess=function(){this.onLoad(false)};this.getPostData=function(){var index=0;var mapData=new Array(0);return mapData};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/home_network/mydhcp_settings.html?webroot=true");c_ipControl_start=$("#ipControl_start").ip_address("ipControl_start");c_ipControl_end=$("#ipControl_end").ip_address("ipControl_end")
};this.setXMLName=function(_xmlname){c_xmlName=_xmlname};return this.each(function(){})};$.fn.objmyphoneBook=function(InIt){var xmlName="";var SMS_NUMBER_PAGE=10;var menuId="";var memStore="";var tags="";var QueryReportTryCount=0;var QuerySmsCmdTryCount=0;var phoneNumberList=null;this.onLoad=function(flag){if(flag){this.loadHTML()}document.getElementById("lt_sms_stcTitle").innerHTML=jQuery.i18n.prop(InIt);var viewModel=new NewsPage();$("#update_apply").click(function(){myrefresh_pb()});$("#send_apply").click(function(){addcontact("")});ko.applyBindings(viewModel);$("#smslist-delete").click(function(){var checkbox=$(".showPassword:checked");var curpage=viewModel.pageIndex();var array=[];console.log("smslist-delete removeitems size->"+removeitems.length);if(removeitems.length>0){for(var i=0;i<removeitems.length;i++){var item={};item.id=+removeitems[i];item.curpage=+curpage;array.push(item)}var url=LOCAL_HOST_IP+"DeleteContactList";$.ajax({type:"GET","beforeSend":function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"))},url:url,dataType:"jsonp",data:{deleList:JSON.stringify(array)},async:false,success:function(res){var obj=eval(res);var state=obj.state;console.log("state "+state);myrefresh_pb()}})}else{$("#smslist-delete").attr("disabled",true)}removeitems.splice(0,removeitems.length)})};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/phoneBook/MyphoneBook.html?webroot=true")};this.onPost=function(){};this.onPostSuccess=function(){};this.setXMLName=function(_xmlname){xmlName=_xmlname};return this};$.fn.myobjUSSD_Settings=function(InIt){var _xmlname="";var _xml="";this.onLoad=function(flag){if(flag){this.loadHTML()}var xml=getData(_xmlname);var issim=$(xml).find("issim").text();$("#ssid1_apply").click(function(){var ussdnumber=$("#ussdnumber").val();var reg=/#/g;var enussdnumber=ussdnumber.replace(reg,"%23");var param={"ussdnumber":enussdnumber};var url=LOCAL_HOST_IP+"ussd";
$.ajax({url:url,dataType:"jsonp",data:"ussdparam="+JSON.stringify(param),async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){var obj=content;console.log("state "+JSON.stringify(obj));var state=obj.state;if(state==1){alert(jQuery.i18n.prop("lSuccess"))}else{alert(jQuery.i18n.prop("lFailed"))}$("#ussdnumber").val("");timesRun=0;if(upgradetimer!=null){console.log("upgradetimer!=null");clearInterval(upgradetimer)}upgradetimer=setInterval("checkUssdBack()",5000)}})})};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/ussd/ussd.html?webroot=true")};this.setXMLName=function(xmlname){_xmlname=xmlname};return this.each(function(){})};$.fn.objWMAC_Filters=function(InIt){var xmlName="";document.getElementById("Content").innerHTML=callProductHTML("html/wireless/wireless_mac_filters.html?webroot=true");function mac_callback(data){var xml=data;var macStatus=$(xml).find("macStatus").text();var allMac=$(xml).find("allMac").text();var macList=allMac.split(",",10);$("#ssid_select_service").empty();$("#ssid_select_service").append('<option value="0">'+jQuery.i18n.prop("lMacDisable")+"</option>"+'<option value="2">'+jQuery.i18n.prop("lMacDeny")+"</option>");$("#ssid_select_service").val(macStatus);if(macStatus=="0"){$("#ssid_mac_list :input").val("");$("#ssid_mac_list :input").attr("disabled","disabled")}else{$("#ssid_mac_list :input").removeAttr("disabled");for(var i=0;i<macList.length;i++){$("#ssid_input_WifiMacFilterMac"+i).val(macList[i])}}console.log("xmlName "+xmlName+" macStatus  "+macStatus+"allMac "+allMac);$("#ssid_select_service").bind("change",function(){var selectedStatus=$("#ssid_select_service").val();wlanmacfilter_ssid_setDisabled();$(".error_message").remove()
})}this.onLoad=function(flag){stone_callProductXML(xmlName,mac_callback)};this.setXMLName=function(_xmlname){xmlName=_xmlname};$("#apply").click(function(){if(checkRepeat()){wlanmacfilert_onApply()}});return this};$.fn.myobjWire_Sec=function(InIt){var _controlMapExisting=new Array(0);var _controlMapCurrent=new Array(0);var _xmlname="";var strSSID="";var _radVINwStatus=null;var _radKeyType=null;var ssid_bcast="";var _xml="";var _cipher="";function wireless_callback(data){var xml=data;var wifiname=$(xml).find("m__ip").text().replace(/0x92/g,"<").replace(/0x93/g,">");var wifikey=$(xml).find("mac__address").text().replace(/0x92/g,"<").replace(/0x93/g,">");var maxnum=$(xml).find("maxnum").text();var iswifihot=$(xml).find("iswifihot").text();var wifitype=$(xml).find("wifitype").text();var bandtype=$(xml).find("bandtype").text();wifitype=0;var AUTH_MODES=["WPA2PSK"];var Band_MODES=["2.4GHz","5GHz"];function verifyDeviceInfo(field){if(field&&field!=""){return field}else{return"�� ��"}}function maxStationOption(max){var options=[];for(var i=1;i<=max;i++){options.push(new Option(i,i))}return options}var viewModel={ssid:ko.observable(verifyDeviceInfo(wifiname)),broadcast:ko.observable(iswifihot),modes:ko.observableArray(AUTH_MODES),bandmodes:ko.observableArray(Band_MODES),selectedMode:ko.observable(AUTH_MODES[wifitype]),selectedBand:ko.observable(Band_MODES[bandtype]),maxStations:ko.observableArray(maxStationOption(8)),passPhrase:ko.observable(verifyDeviceInfo(wifikey)),showPassword:ko.observable(false),lcd_showPassword:ko.observable(false),selectedStation:ko.observable(maxnum),data_roaming_click:ko.observable(false),mobile_data_click:ko.observable(false),showPasswordHandler:function(data,event){$("#passShow").parent().find(".error").hide();var checkbox=$("#showPassword:checked");if(checkbox&&checkbox.length==0){viewModel.showPassword(true)}else{viewModel.showPassword(false)}},lcd_showPasswordHandler:function(data,event){$("#passShow").parent().find(".error").hide();var checkbox=$("#lcd_showPassword:checked");
if(checkbox&&checkbox.length==0){viewModel.lcd_showPassword(true)}else{viewModel.lcd_showPassword(false)}},clear:function(option){if(option=="ssid1"){console.log("iswifihotsssssssssssssssssssss wifitype "+wifitype+" "+AUTH_MODES[wifitype]);viewModel.ssid(verifyDeviceInfo(wifiname));viewModel.broadcast(iswifihot);viewModel.modes(AUTH_MODES);viewModel.selectedMode(AUTH_MODES[wifitype]);viewModel.selectedBand(Band_MODES[bandtype]);viewModel.maxStations(maxStationOption(8));viewModel.passPhrase(verifyDeviceInfo(wifikey));viewModel.showPassword(false);viewModel.lcd_showPassword(false);viewModel.selectedStation(maxnum)}}};ko.applyBindings(viewModel);function checkword(str){for(var i=0;i<str.length;i++){if(str.charCodeAt(i)<1||str.charCodeAt(i)>254){return false}}return true}$("#ssid1_apply").click(function(){var useid=$.trim($("#ssid").val());var passwd=$.trim($("#pass").val());var iswifihot=viewModel.broadcast();console.log("iswifihot"+iswifihot);var maxcount=$("#maxStation").val();var wifitype=4;var bandtype=0;var mode=$("#mode").val();var bandmode=$("#bandmode").val();if(bandmode=="5GHz"){bandtype=1}else{bandtype=0}if(useid==""){alert(jQuery.i18n.prop("lSsidEmpty"));return}if(passwd==""){alert(jQuery.i18n.prop("lPwdEmpty"));return}if(useid.indexOf(" ")!=-1){alert(jQuery.i18n.prop("LSsidblank"));return}if(passwd.indexOf(" ")!=-1){alert(jQuery.i18n.prop("lPwdblank"));return}if(!checkword(useid)){alert(jQuery.i18n.prop("LSsidSpecial"));return}if(!checkword(passwd)){alert(jQuery.i18n.prop("lPwdSpecial"));return}if(useid.length>32||useid.length<1){alert(jQuery.i18n.prop("lSsidLength"));return}if(passwd.length>60||passwd.length<8){alert(jQuery.i18n.prop("lPwdLength"));return}var param={"username":useid,"password":passwd,"maxcount":maxcount,"iswifihot":iswifihot,"wifitype":wifitype,"bandtype":bandtype};var issucess=false;var url=LOCAL_HOST_IP+"changeWifi";$.ajax({url:url,dataType:"jsonp",data:{wifiparam:JSON.stringify(param)},async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));
xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){console.log("issucess state "+content);var obj=content;console.log("state "+JSON.stringify(obj));var state=obj.state;console.log("state "+state);if(state==1){alert(jQuery.i18n.prop("vSuccess"))}else{alert(jQuery.i18n.prop("vFailed"))}}})});function Completefun(evt){console.log(evt.target.responseText);alert(jQuery.i18n.prop("lWirelessSetSuccess"))}}this.onLoad=function(flag){if(flag){this.loadHTML()}document.getElementById("title").innerHTML=jQuery.i18n.prop(InIt);stone_callProductXML(_xmlname,wireless_callback)};this.onPostSuccess=function(){this.onLoad(false)};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/wireless/mywireless_network.html?webroot=true")};this.setXMLName=function(xmlname){_xmlname=xmlname};return this.each(function(){})};$.fn.objdashboard=function(oInit){var _xmlname="";this.onLoad=function(flag){if(flag){this.loadHTML();this.Localize()}stone_callProductXML(_xmlname,setDashboardValue)};this.onPostSuccess=function(){this.onLoad(false)};this.Localize=function(){$("h2,strong,a,span").each(function(){$(this).text(jQuery.i18n.prop($(this).attr("id")))})};this.loadHTML=function(){document.getElementById("mainColumn").innerHTML="";document.getElementById("mainColumn").innerHTML=callProductHTML("html/dashboard.html?webroot=true")};this.setXMLName=function(xmlname){_xmlname=xmlname};return this.each(function(){})};$.fn.quick_setup=function(oInit){this.loadHtml=function(){document.getElementById("navigation").innerHTML="<ul id ='menu' ><li ><a id='menuQuickSetup' class='on'>Quick Setup </a> </li> </ul>";document.getElementById("menuQuickSetup").innerHTML=jQuery.i18n.prop("quickSetupName");document.getElementById("mainColumn").innerHTML="";document.getElementById("mainColumn").innerHTML=callProductHTML("html/quick_setup.html?webroot=true");
if("dongle"==g_platformName){document.getElementById("h1WirelessSeetings").style.display="none"}document.getElementById("h1UserSettings").innerHTML=jQuery.i18n.prop("h1UserSettings");document.getElementById("h1InternetConnection").innerHTML=jQuery.i18n.prop("h1InternetConnection");document.getElementById("h1WirelessSeetings").innerHTML=jQuery.i18n.prop("h1WirelessSeetings");document.getElementById("h1DevicePlaceGuid").innerHTML=jQuery.i18n.prop("h1DevicePlaceGuid");$(".navigation ul li").width(948);$(".navigation ul li a").css("text-align","left");$(".navigation ul li a").css("padding-left","10px");$(".navigation ul li a.on").css("background-position","left");$("#uploadISPFileForm").ajaxForm({success:function(){hm()},error:function(){hm()},beforeSend:function(){if(document.getElementById("fileName").value.toString().lastIndexOf(".xml")==-1){showAlert(jQuery.i18n.prop("XMLExtError"));return false}else{}return true}});var h1Elements=document.getElementsByTagName("h1");lableLocaliztion(h1Elements);var arrayLabels=document.getElementsByTagName("label");lableLocaliztion(arrayLabels);showDiv("MBQuickSetupMainPage",400,220);addClassQSon("h1UserSettings");MBQuickSetupMainPageLoadData()};this.onPostSuccess=function(){username=username1;passwd=passwd1;hideDiv()};return this.each(function(){})};$.fn.objUserManage=function(InIt){var controlMapExisting=new Array(0);var controlMapCurrent=new Array(0);var xmlName="";this.onLoad=function(flag){var index=0;_arrayTableDataAccount=new Array(0);var indexAccount=0;if(flag){this.loadHTML();document.getElementById("title").innerHTML=jQuery.i18n.prop(InIt);var arrayLabels=document.getElementsByTagName("label");lableLocaliztion(arrayLabels);var buttonID=document.getElementById("btUpdate").id;buttonLocaliztion(buttonID);buttonLocaliztion("btnAddNewAccount");arrayLabels=document.getElementsByTagName("th");lableLocaliztion(arrayLabels);arrayLabels=document.getElementsByTagName("td");lableLocaliztion(arrayLabels);arrayLabels=document.getElementsByTagName("h1");
lableLocaliztion(arrayLabels);$("#opt_restricted").text(jQuery.i18n.prop("opt_restricted"));$("#opt_standard").text(jQuery.i18n.prop("opt_standard"))}var xml=getData(xmlName);var _router_username;var _router_password;var router_username_;var router_password_;var authority;var login_account_index;var is_admin_account;g_login_name="";g_login_password="";$(xml).find("management").each(function(){gMtltiAccount=$(this).find("multi_account").text();_router_username=decodeURIComponent($(this).find("router_username").text());_router_password=decodeURIComponent($(this).find("router_password").text())});if(gMtltiAccount=="0"){document.getElementById("User_Password_Reset_div").style.display="block";document.getElementById("User_Account_div").style.display="none";document.getElementById("tbrouter_username").value=_router_username;document.getElementById("tbrouter_password").value=_router_password;document.getElementById("tbreenter_password").value=decodeURIComponent($(this).find("router_password").text());controlMapExisting=g_objXML.putMapElement(controlMapExisting,index++,"RGW/management/router_username",_router_username);controlMapExisting=g_objXML.putMapElement(controlMapExisting,index,"RGW/management/router_password",_router_password);controlMapCurrent=g_objXML.copyArray(controlMapExisting,controlMapCurrent)}else{document.getElementById("User_Password_Reset_div").style.display="none";document.getElementById("User_Account_div").style.display="block";$(xml).find("router_user_list").each(function(){$(this).find("Item").each(function(){router_username_=decodeURIComponent($(this).find("username").text());router_password_=decodeURIComponent($(this).find("password").text());authority=$(this).find("authority").text();if(router_username_==username){login_account_index=indexAccount}_arrayTableDataAccount[indexAccount]=new Array(3);_arrayTableDataAccount[indexAccount][0]=router_username_;_arrayTableDataAccount[indexAccount][1]=router_password_;_arrayTableDataAccount[indexAccount][2]=authority;
indexAccount++})});if(indexAccount>0){g_login_name=_arrayTableDataAccount[login_account_index][0];g_login_password=_arrayTableDataAccount[login_account_index][1];is_admin_account=_arrayTableDataAccount[login_account_index][2]}loadAccountTable(_arrayTableDataAccount);if(g_login_name!="admin"){$("#btnAddNewAccount").attr("disabled",true);$("#btnAddNewAccount").css({"background-image":"url(../images/disabledBtn.png?webroot=true)","color":"#adadad","cursor":"default"})}else{$("#btnAddNewAccount").attr("disabled",false)}}};function AdminCallBackFun(retXml){var index=0;_arrayTableDataAccount=new Array(0);var indexAccount=0;var _router_username;var _router_password;var router_username_;var router_password_;var authority;var login_account_index;var is_admin_account;g_login_name="";g_login_password="";$(retXml).find("management").each(function(){gMtltiAccount=$(this).find("multi_account").text();_router_username=decodeURIComponent($(this).find("router_username").text());_router_password=decodeURIComponent($(this).find("router_password").text())});if(gMtltiAccount=="0"){document.getElementById("User_Password_Reset_div").style.display="block";document.getElementById("User_Account_div").style.display="none";document.getElementById("tbrouter_username").value=_router_username;document.getElementById("tbrouter_password").value=_router_password;document.getElementById("tbreenter_password").value=decodeURIComponent($(this).find("router_password").text());controlMapExisting=g_objXML.putMapElement(controlMapExisting,index++,"RGW/management/router_username",_router_username);controlMapExisting=g_objXML.putMapElement(controlMapExisting,index,"RGW/management/router_password",_router_password);controlMapCurrent=g_objXML.copyArray(controlMapExisting,controlMapCurrent)}else{document.getElementById("User_Password_Reset_div").style.display="none";document.getElementById("User_Account_div").style.display="block";$(retXml).find("router_user_list").each(function(){$(this).find("Item").each(function(){router_username_=decodeURIComponent($(this).find("username").text());
router_password_=decodeURIComponent($(this).find("password").text());authority=$(this).find("authority").text();if(router_username_==username){login_account_index=indexAccount}_arrayTableDataAccount[indexAccount]=new Array(3);_arrayTableDataAccount[indexAccount][0]=router_username_;_arrayTableDataAccount[indexAccount][1]=router_password_;_arrayTableDataAccount[indexAccount][2]=authority;indexAccount++})});if(indexAccount>0){g_login_name=_arrayTableDataAccount[login_account_index][0];g_login_password=_arrayTableDataAccount[login_account_index][1];is_admin_account=_arrayTableDataAccount[login_account_index][2];username=g_login_name;passwd=g_login_password}loadAccountTable(_arrayTableDataAccount);if(g_login_name!="admin"){$("#btnAddNewAccount").attr("disabled",true);$("#btnAddNewAccount").css({"background-image":"url(../images/disabledBtn.png?webroot=true)","color":"#adadad","cursor":"default"})}else{$("#btnAddNewAccount").attr("disabled",false)}}}function loadAccountTable(arrayTableData){var tableUserAccount=document.getElementById("tableUserAccount");var tBodytable=tableUserAccount.getElementsByTagName("tbody")[0];clearTabaleRows("tableUserAccount");if(arrayTableData.length==0){var row1=tBodytable.insertRow(0);var rowCol1=row1.insertCell(0);rowCol1.colSpan=3;rowCol1.innerHTML=jQuery.i18n.prop("tableNoData")}else{for(var i=0;i<arrayTableData.length;i++){var arrayTableDataRow=arrayTableData[i];var row=tBodytable.insertRow(-1);var AccountNameCol=row.insertCell(0);var AuthorityCol=row.insertCell(1);var removeCol=row.insertCell(2);var _name=decodeURIComponent(arrayTableDataRow[0]);AccountNameCol.innerHTML="<a href='#' id ='table_username_link"+i+"' onclick='AccountClicked("+i+")'>"+_name+"</a>";if(arrayTableDataRow[2]=="1"){AuthorityCol.innerHTML=jQuery.i18n.prop("lStandard")}else{AuthorityCol.innerHTML=jQuery.i18n.prop("lRestricted")}removeCol.innerHTML="<a href='#' id='table_remove_link"+i+"' onclick='deleteAccountItem("+i+")'>"+jQuery.i18n.prop("lRemove")+"</a>";if(g_login_name!="admin"){if(g_login_name!=_name){$("#table_username_link"+i+"").attr("onclick",null);
$("#table_username_link"+i+"").css("color","gray")}$("#table_remove_link"+i+"").attr("onclick",null);$("#table_remove_link"+i+"").css("color","gray")}else{if(g_login_name==_name){$("#table_remove_link"+i+"").attr("onclick",null);$("#table_remove_link"+i+"").css("color","gray")}}}}Table.stripe(tableUserAccount,"alternate","table-stripeclass")}this.getTableAccountDataRow=function(index){return _arrayTableDataAccount[index]};this.postAccountItem=function(index,isDeleted,name,password,authority){var itemIndex=0;mapData=null;mapData=new Array();var login_username=encodeURIComponent(document.getElementById("tbrouter_username").value);var login_password=encodeURIComponent(document.getElementById("tbrouter_password").value);this.putMapElement("RGW/management/router_username",login_username,itemIndex++);this.putMapElement("RGW/management/router_password",login_password,itemIndex++);if(isDeleted){var _name=encodeURIComponent(name);var _password=encodeURIComponent(password);this.putMapElement("RGW/management/account_management/account_action",2,itemIndex++);this.putMapElement("RGW/management/account_management/account_username",_name,itemIndex++);this.putMapElement("RGW/management/account_management/account_password",_password,itemIndex++);this.putMapElement("RGW/management/router_user_list/Item#index",index,itemIndex++);this.putMapElement("RGW/management/router_user_list/Item/username#delete",_name,itemIndex++)}else{var item_name=encodeURIComponent(name);var item_password=encodeURIComponent(password);this.putMapElement("RGW/management/account_management/account_action",1,itemIndex++);this.putMapElement("RGW/management/account_management/account_username",item_name,itemIndex++);this.putMapElement("RGW/management/account_management/account_password",item_password,itemIndex++);this.putMapElement("RGW/management/router_user_list/Item#index",index,itemIndex++);this.putMapElement("RGW/management/router_user_list/Item/username",item_name,itemIndex++);this.putMapElement("RGW/management/router_user_list/Item/password",item_password,itemIndex++);
this.putMapElement("RGW/management/router_user_list/Item/authority",authority,itemIndex++)}if(mapData.length>0){PostXMLWithResponse(xmlName,g_objXML.getXMLDocToString(g_objXML.createXML(mapData)),AdminCallBackFun)}};this.putMapElement=function(xpath,value,index){mapData[index]=new Array(2);mapData[index][0]=xpath;mapData[index][1]=value};this.onPost=function(){if(this.isValid()){document.getElementById("lPassErrorMes").style.display="none";var _controlMap=this.getPostData();if(_controlMap.length>0){PostXMLWithResponse(xmlName,g_objXML.getXMLDocToString(g_objXML.createXML(_controlMap)),AdminCallBackFun)}}};this.onPostSuccess=function(){if(gMtltiAccount=="0"){username=encodeURIComponent(document.getElementById("tbrouter_username").value);passwd=encodeURIComponent(document.getElementById("tbrouter_password").value)}this.onLoad(false)};this.isValid=function(){return isValidAdminPage()};this.getPostData=function(){var index=0;var mapData=new Array(0);controlMapCurrent[index++][1]=encodeURIComponent(document.getElementById("tbrouter_username").value);controlMapCurrent[index++][1]=encodeURIComponent(document.getElementById("tbrouter_password").value);mapData=g_objXML.copyArray(controlMapCurrent,mapData);mapData=g_objXML.getChangedArray(controlMapExisting,mapData,true);return mapData};this.setXMLName=function(_xmlname){xmlName=_xmlname};this.loadHTML=function(){document.getElementById("Content").innerHTML="";document.getElementById("Content").innerHTML=callProductHTML("html/router/user_management.html?webroot=true")};return this.each(function(){})}})(jQuery);function showDlg(index){clearInterval(_connectedDeviceIntervalID);connetedDeviceSelectedIndex=index;sm("box",350,200);getID("tbModal").value=g_objContent.getName(index);getID("tbModal").focus();getID("tbModal").focus();document.getElementById("btnModalOk").innerHTML=jQuery.i18n.prop("btnModalOk");document.getElementById("btnModalReset").innerHTML=jQuery.i18n.prop("btnModalReset");document.getElementById("lModalHeader").innerHTML=jQuery.i18n.prop("lModalHeader");
document.getElementById("h1DeviceHeader").innerHTML=jQuery.i18n.prop("h1DeviceHeader")}function btnOkSelected(){_connectedDeviceIntervalID=setInterval("g_objContent.onLoad()",_connectedDeviceInterval);var index=connetedDeviceSelectedIndex;var strName=getID("tbModal").value;strName=encodeURIComponent(strName);if(strName!=""){if(deviceNameValidation(strName)){g_objContent.postItem(index,g_objContent.getBlocked(index),true,strName)}else{getID("ErrInvalidName").style.display="block";getID("ErrInvalidName").innerHTML=jQuery.i18n.prop("ErrInvalidName")}}}function btnCancelClicked(){_connectedDeviceIntervalID=setInterval("g_objContent.onLoad()",_connectedDeviceInterval)}function btnRemoveSelected(){_connectedDeviceIntervalID=setInterval("g_objContent.onLoad(false)",_connectedDeviceInterval);var index=connetedDeviceSelectedIndex;g_objContent.postItemRemoveDeviceEntry(index)}function blockUnblock(index,value){g_objContent.postItem(index,value,false,null)}function drpdwn_DHCP_rangeChanged(){var value="192.168";var _ipControl_start=$().ip_address("ipControl_start");_ipControl_start.clearHTML();_ipControl_start.formatIP(value);var _ipControl_end=$().ip_address("ipControl_end");_ipControl_end.clearHTML();_ipControl_end.formatIP(value)}function checkUssdBack(){var url=LOCAL_HOST_IP+"ussdback";$.ajax({url:url,dataType:"jsonp",async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){var obj=content;console.log("checkUssdBack "+JSON.stringify(obj));var state=obj.state;if(state==""){$("#lussdback").text("No Data back")}else{$("#lussdback").text(state);clearInterval(upgradetimer)}timesRun+=1;if(timesRun==10){clearInterval(upgradetimer)}}})}function setDashboardValue(content){var xml=content;console.log("objdashboard xml:",xml);console.log("objdashboard imei:",$(xml).find("imei").text());
var issim=$(xml).find("issim").text();console.log("objdashboard issim=",issim);setLabelValue("lDashRouterImeiValue",$(xml).find("imei").text());setLabelValue("lRouterIP",$(xml).find("ipAddress").text());setLabelValue("lRouterMask",$(xml).find("networkmask").text());setLabelValue("lRouterMAC",$(xml).find("macAddress").text());setLabelValue("lDashRunSecondsValue",$(xml).find("functionTimes").text());setLabelValue("lDashStrengthDbm",$(xml).find("strengthDbm").text());setLabelValue("lDashNetworkTypeValue",$(xml).find("networkType").text());setLabelValue("lSecurityModeValue",$(xml).find("wifisafetype").text());setLabelValue("lWirelessNwValue",$(xml).find("wifihotname").text());setLabelValue("lDeviceModelValue",$(xml).find("imsi").text());setLabelValue("lSoftVersion",$(xml).find("swVersion").text());setLabelValue("lHardVersion",$(xml).find("hwVersion").text());setLabelValue("lConnDeviceValue",$(xml).find("hotcount").text());document.getElementById("imgConnDevice").src="images/status-icon3.png?webroot=true"}function setLabelValue(id,value){document.getElementById(id).innerHTML=value}function setLabelValueProp(id,prop){document.getElementById(id).innerHTML=jQuery.i18n.prop(prop)}function setLabelValueEnabledDisabled(id,flag,imgID){document.getElementById(imgID).style.display="block";if(flag==1){document.getElementById(id).innerHTML=jQuery.i18n.prop("lEnabled");document.getElementById(imgID).src="images/status-icon3.png?webroot=true"}else{document.getElementById(id).innerHTML=jQuery.i18n.prop("lDisabled");document.getElementById(imgID).src="images/status-icon2.png?webroot=true"}}function quickSetup(){document.getElementById("lableWelcome").innerHTML=jQuery.i18n.prop("lableWelcome");document.getElementById("quickSetupSpan").innerHTML="<a href='#.' id='quickSetupspanlink' onclick=getHelp('QuickSetup')>Help</a>";document.getElementById("quickSetupspanlink").innerHTML=jQuery.i18n.prop("helpName");g_QuickSetup=$("#mainColumn").quick_setup();clearRefreshTimers();g_QuickSetup.loadHtml();
if("dongle"==g_platformName){document.getElementById("btnNext1").onclick=btnQSNextClicked1;document.getElementById("btnBack4").onclick=btnBackClicked2}document.getElementById("btnExit").innerHTML=jQuery.i18n.prop("btnExit");buttonLocaliztion(document.getElementById("btnNext").id)}function btnQSNextClicked(){username1=encodeURIComponent(document.getElementById("tbrouter_username").value);passwd1=encodeURIComponent(document.getElementById("tbrouter_password").value);if(validatePasswordQS()){if(isValidAdminPage()){postModityUsermanage(username1,passwd1);document.getElementById("MBQuickSetupMainPage").style.display="none";document.getElementById("btnExit1").innerHTML=jQuery.i18n.prop("btnExit1");buttonLocaliztion(document.getElementById("btnBack1").id);buttonLocaliztion(document.getElementById("btnNext1").id);$("#h1UserSettings").removeClass("on");SetInternetConnection()}}}function postModityUsermanage(uername,passwds){var param={"uername":uername,"passwds":passwds};var issucess=false;var url=LOCAL_HOST_IP+"QuickSetUser";$.ajax({url:url,dataType:"jsonp",data:{modifyparam:JSON.stringify(param)},async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){var obj=content;var state=obj.state;if(state==1){alert("Success")}else{alert("Old passwords are error")}}})}function SetUserNameAndPasswd(){var mapData=new Array();var index=0;if(g_multi_account=="1"){if(passwd1!=g_router_password){mapData=putMapElement(mapData,"RGW/management/account_management/account_action",1,index++);mapData=putMapElement(mapData,"RGW/management/account_management/account_username",username1,index++);mapData=putMapElement(mapData,"RGW/management/account_management/account_password",passwd1,index++);mapData=putMapElement(mapData,"RGW/management/router_user_list/Item#index",index,index++);
mapData=putMapElement(mapData,"RGW/management/router_user_list/Item/username",username1,index++);mapData=putMapElement(mapData,"RGW/management/router_user_list/Item/password",passwd1,index++);mapData=putMapElement(mapData,"RGW/management/router_user_list/Item/authority",1,index++)}}else{if(username1!=g_router_username){mapData=putMapElement(mapData,"RGW/management/router_username",username1,index++)}if(passwd1!=g_router_password){mapData=putMapElement(mapData,"RGW/management/router_password",passwd1,index++)}}if(mapData.length>0){PostSyncXMLEx("admin",g_objXML.getXMLDocToString(g_objXML.createXML(mapData)),function(){username=username1;passwd=passwd1})}}function btnExitClicked(id){hideDiv()}function btnFinishClicked(){alert(jQuery.i18n.prop("vSetWizardcomplete"));hideDiv()}function btnQSNextClicked1(){document.getElementById("MBQuickSetupPage1").style.display="none";$("#h1InternetConnection").removeClass("on");SetPrimaryNetwork()}function SetPrimaryNetwork(){document.getElementById("MBQuickSetupPage2").style.display="block";document.getElementById("divPrimaryNetworkSet").innerHTML=callProductHTML("html/wireless/quickwireless.html?webroot=true");setLocalization(getCookie("locale"));g_objContent=null;g_objContent=$("#MBQuickSetupPage2").myobjWire_Sec();g_objContent.setXMLName("uapxb_wlan_security_settings");g_objContent.onLoad(false);g_PrimaryNetworkObj=g_objContent;$("#primaryNetworkHelp").hide();$("#divSavePrimaryNetworkData").hide();$("#lPassErrorMesPN").hide();document.getElementById("btnExit3").innerHTML=jQuery.i18n.prop("btnExit3");buttonLocaliztion(document.getElementById("btnBack3").id);buttonLocaliztion(document.getElementById("btnNext3").id);addClassQSon("h1WirelessSeetings")}function btnQSNextClicked2(){var useid=$("#ssid").val();var passwd=$("#pass").val();var iswifihot=1;var maxcount=$("#maxStation").val();var wifitype=1;var bandtype=0;var mode=$("#mode").val();var bandmode=$("#bandmode").val();if(mode=="WPA2PSK"){wifitype=1}else{if(mode=="OPEN"){wifitype=0
}else{wifitype=4}}if(bandmode=="5GHz"){bandtype=1}else{bandtype=0}if($.trim(useid)==""){alert(jQuery.i18n.prop("vHotspotEmpty"));return}if(passwd.length>7){var param={"username":useid,"password":passwd,"maxcount":maxcount,"iswifihot":iswifihot,"wifitype":wifitype,"bandtype":bandtype};var issucess=false;var url=LOCAL_HOST_IP+"changeWifi";$.ajax({url:url,dataType:"jsonp",data:"wifiparam="+JSON.stringify(param),async:false,cache:false,beforeSend:function(xhr){xhr.setRequestHeader("Authorization",getAuthHeader("GET"));xhr.setRequestHeader("Expires","-1");xhr.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");xhr.setRequestHeader("Pragma","no-cache")},success:function(content){var obj=content;var state=obj.state;if(state==1){alert(jQuery.i18n.prop("vWlanSuccess"))}else{alert(jQuery.i18n.prop("vWlanFailed"))}}})}else{alert(jQuery.i18n.prop("vWlanPwderror"));return}showDiv("MBQuickSetupPage3",400,220);buttonLocaliztion(document.getElementById("btnBack4").id);buttonLocaliztion(document.getElementById("btnFinish").id);document.getElementById("MBQuickSetupPage2").style.display="none";MBQuickSetupPage3Localization();addClassQSon("h1DevicePlaceGuid")}function MBQuickSetupPage3Localization(){getID("Microwave").innerHTML=jQuery.i18n.prop("Microwave");getID("Bluetooth_Devices").innerHTML=jQuery.i18n.prop("Bluetooth_Devices");getID("Cordless_Phone").innerHTML=jQuery.i18n.prop("Cordless_Phone");getID("ownDevices").innerHTML=jQuery.i18n.prop("ownDevices");getID("Baby_Monitor").innerHTML=jQuery.i18n.prop("Baby_Monitor")}function btnBackClicked1(){document.getElementById("MBQuickSetupPage1").style.display="none";showDiv("MBQuickSetupMainPage",400,220);document.getElementById("btnExit").innerHTML=jQuery.i18n.prop("btnExit");buttonLocaliztion(document.getElementById("btnNext").id);g_objContent=g_InternetConnectionObj;addClassQSon("h1UserSettings");MBQuickSetupMainPageLoadData()}function btnBackClicked2(){if("dongle"==g_platformName){document.getElementById("MBQuickSetupPage3").style.display="none"
}else{document.getElementById("MBQuickSetupPage2").style.display="none"}SetInternetConnection()}function SetInternetConnection(){document.getElementById("MBQuickSetupPage1").style.display="block";document.getElementById("divInternetConnectSet").innerHTML=callProductHTML("html/internet/myinternet_connection.html?webroot=true");setLocalization(getCookie("locale"));$("#inter_help").hide();$("#divFormBox").hide();$("#divSaveButton").hide();$("#title").hide();$("#h1WirelessSeetings").removeClass("on");document.getElementById("btnExit1").innerHTML=jQuery.i18n.prop("btnExit1");buttonLocaliztion(document.getElementById("btnBack1").id);buttonLocaliztion(document.getElementById("btnNext1").id);g_objContent=null;g_objContent=$("#MBQuickSetupPage1").myobjInternetConn();g_objContent.setXMLName("internetconn");g_objContent.onLoad(false);g_InternetConnectionObj=g_objContent;addClassQSon("h1InternetConnection")}function btnBackClicked3(){document.getElementById("MBQuickSetupPage3").style.display="none";$("#h1DevicePlaceGuid").removeClass("on");if("mifi"==g_platformName){SetPrimaryNetwork()}else{SetInternetConnection()}}function showDiv(divid,width,height){removeClassQS();document.getElementById(divid).style.display="block";g_InternetConnectionObj=null;g_PrimaryNetworkObj=null}function hideDiv(){document.getElementById("lableWelcome").innerHTML=jQuery.i18n.prop("lableWelcome");document.getElementById("quickSetupSpan").innerHTML='<a href="#."  onclick="quickSetup()" id="quickSetup" >Quick Setup</a>  |  <a href="#." id="HelpName" onclick="getMainHelp()">Help</a>  |  <a href="#."  id="LogOutName"  onclick="logOut()">Log Out</a>';document.getElementById("quickSetup").innerHTML=jQuery.i18n.prop("quickSetupName");document.getElementById("HelpName").innerHTML=jQuery.i18n.prop("helpName");document.getElementById("LogOutName").innerHTML=jQuery.i18n.prop("LogOutName");document.getElementById("navigation").innerHTML=" <ul id ='menu'></ul>";g_InternetConnectionObj=null;g_PrimaryNetworkObj=null;createMenuFromXML();
createMenu(1)}function MBQuickSetupMainPageLoadData(){var xmlAdmin=getData("admin");var xmlLocale=getData("locale");var index=0;var router_username_;var router_password_;var authority;var _arrayTableDataAccount=new Array(0);var indexAccount=0;var login_account_index;timezoneStringArrayQS[0]=new Array();timezoneStringArrayQS[1]=new Array();$(xmlAdmin).find("management").each(function(){g_multi_account=$(this).find("multi_account").text()});if(g_multi_account=="1"){$(xmlAdmin).find("router_user_list").each(function(){$(this).find("Item").each(function(){router_username_=decodeURIComponent($(this).find("username").text());router_password_=decodeURIComponent($(this).find("password").text());authority=$(this).find("authority").text();if(router_username_==username){login_account_index=indexAccount}_arrayTableDataAccount[indexAccount]=new Array(3);_arrayTableDataAccount[indexAccount][0]=router_username_;_arrayTableDataAccount[indexAccount][1]=router_password_;_arrayTableDataAccount[indexAccount][2]=authority;indexAccount++})});g_router_username=_arrayTableDataAccount[login_account_index][0];g_router_password=_arrayTableDataAccount[login_account_index][1];document.getElementById("tbrouter_username").value=g_router_username;document.getElementById("tbrouter_password").value=g_router_password;document.getElementById("tbreenter_password").value=g_router_password;document.getElementById("tbrouter_username").readOnly=true}else{$(xmlAdmin).find("management").each(function(){g_router_username=decodeURIComponent($(this).find("router_username").text());g_router_password=decodeURIComponent($(this).find("router_password").text());document.getElementById("tbrouter_username").value=g_router_username;document.getElementById("tbrouter_password").value=g_router_password;document.getElementById("tbreenter_password").value=g_router_password;document.getElementById("tbrouter_username").readOnly=false})}}function rbTimeZoneCickedQS(){if(document.getElementById("getConnDevTimeZone").checked==true){setMachineTimezoneQS()
}}function setMachineTimezoneQS(){var i=GetMachineTimezoneGmtOffset();var gmtOffset=GetMachineTimezoneGmtOffsetStr(i);var dstStr=GetMachineTimezoneDstStartStr(i);indexString=setConnectedDeviceTimezoneStr(gmtOffset,dstStr,timezoneStringArrayQS);if(indexString!=-1){document.getElementById("lConnectedDeviceTimeZone").innerHTML=timezoneStringArrayQS[0][indexString]}else{document.getElementById("lConnectedDeviceTimeZone").innerHTML=jQuery.i18n.prop("ErrTimeZoneNotFound")}}function validatePasswordQS(){if(document.getElementById("tbrouter_password").value!=document.getElementById("tbreenter_password").value){document.getElementById("lPassErrorMes").style.display="block";document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("lPassErrorMes");document.getElementById("tbreenter_password").value="";return false}else{document.getElementById("lPassErrorMes").style.display="none";return true}}function removeClassQS(){document.getElementById("h1UserSettings").className="";document.getElementById("h1InternetConnection").className="";document.getElementById("h1WirelessSeetings").className="";document.getElementById("h1DevicePlaceGuid").className=""}function addClassQSon(id){document.getElementById(id).className="on"}function passwordChanged(){document.getElementById("tbreenter_password").value="";document.getElementById("lRePassword").style.display="block";document.getElementById("tbreenter_password").style.display="block"}function validatePassword(){if(document.getElementById("tbrouter_password").value!=document.getElementById("tbreenter_password").value){document.getElementById("lPassErrorMes").style.display="block";document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("lPassErrorMes");document.getElementById("tbreenter_password").value=""}else{document.getElementById("lPassErrorMes").style.display="none";setData()}}function isValidAdminPage(){if(!(textBoxMinLength("tbrouter_username",4)&&textBoxMinLength("tbrouter_password",4))){document.getElementById("lPassErrorMes").style.display="block";
document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("lminLengthError");return false}if(!(textBoxMaxLength("tbrouter_username",20)&&textBoxMaxLength("tbrouter_password",20))){document.getElementById("lPassErrorMes").style.display="block";document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("lmaxLengthError");return false}if(!isNumberOrLetter(document.getElementById("tbrouter_username").value)){document.getElementById("lPassErrorMes").style.display="block";document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("ErrInvalidUserPass");return false}if(!isNumberOrLetter(document.getElementById("tbrouter_password").value)){document.getElementById("lPassErrorMes").style.display="block";document.getElementById("lPassErrorMes").innerHTML=jQuery.i18n.prop("ErrInvalidUserPass");return false}return true}function deleteAccountItem(index){var data=g_objContent.getTableAccountDataRow(index);g_objContent.postAccountItem(index,true,data[0],data[1])}function AddNewAccount(){if(document.getElementById("tableUserAccount").rows.length<=4){sm("MBAccount_Popup",450,200);localizeMBAccount();$("#opt_restricted").text(jQuery.i18n.prop("opt_restricted"));$("#opt_standard").text(jQuery.i18n.prop("opt_standard"));document.getElementById("txtAccountName").readOnly=false;$("#AccountGroupSelect").val(0);$("#AccountGroupSelect").attr("disabled",true);$("#txtAccountName").attr("readonly",false);$("#txtAccountName").attr("disabled",false);bEditAccount=false}else{showAlert(jQuery.i18n.prop("lMaxAccountError"))}}function localizeMBAccount(){document.getElementById("h1AccountEdit").innerHTML=jQuery.i18n.prop("h1AccountEdit");document.getElementById("lAccountName").innerHTML=jQuery.i18n.prop("lAccountName");document.getElementById("lAccountPassword").innerHTML=jQuery.i18n.prop("lAccountPassword");document.getElementById("lReAccountPassword").innerHTML=jQuery.i18n.prop("lReAccountPassword");document.getElementById("lAccountAuthority").innerHTML=jQuery.i18n.prop("lAccountAuthority");
document.getElementById("btnCancel").innerHTML=jQuery.i18n.prop("btnCancel");buttonLocaliztion(document.getElementById("btnOk").id)}function AccountClicked(index){sm("MBAccount_Popup",450,200);localizeMBAccount();var data=g_objContent.getTableAccountDataRow(index);document.getElementById("txtAccountName").value=data[0];document.getElementById("txtAccountName").readonly=true;document.getElementById("txtAccountPassword").value=data[1];document.getElementById("txtReAccountPassword").value=decodeURIComponent(data[1]);document.getElementById("AccountGroupSelect").value=data[2];$("#opt_restricted").text(jQuery.i18n.prop("opt_restricted"));$("#opt_standard").text(jQuery.i18n.prop("opt_standard"));$("#AccountGroupSelect").attr("disabled",true);$("#txtAccountName").attr("disabled",true);$("#txtAccountName").attr("readonly",true);bEditAccount=true}function tablepasswordChanged(){document.getElementById("txtReAccountPassword").value="";document.getElementById("lReAccountPassword").style.display="block";document.getElementById("txtReAccountPassword").style.display="block"}function isValidAccountPage(){if(!(textBoxMinLength("txtAccountName",4)&&textBoxMinLength("txtAccountPassword",4))){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("lminLengthError");return false}if(!(textBoxMaxLength("txtAccountName",20)&&textBoxMaxLength("txtAccountPassword",20))){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("lmaxLengthError");return false}if(!isNumberOrLetter(document.getElementById("txtAccountName").value)){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("ErrInvalidUserPass");return false}if(!isNumberOrLetter(document.getElementById("txtAccountPassword").value)){document.getElementById("lTablePassErrorMes").style.display="block";
document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("ErrInvalidUserPass");return false}return true}function btnOKClickedEditAccount(){var AccountName,AccountPassword,AccountRePassword,AccountAuthority;AccountName=document.getElementById("txtAccountName").value;AccountPassword=document.getElementById("txtAccountPassword").value;AccountRePassword=document.getElementById("txtReAccountPassword").value;AccountAuthority=document.getElementById("AccountGroupSelect").value;if(isChineseChar(AccountName)){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("APN_AHTU_USER_NAME_INVALIDEATE");return}if(!bEditAccount){for(var idx=0;idx<_arrayTableDataAccount.length;++idx){if(AccountName==_arrayTableDataAccount[idx][0]){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("lAccountExist");return}}}if(document.getElementById("txtAccountPassword").value!=document.getElementById("txtReAccountPassword").value){document.getElementById("lTablePassErrorMes").style.display="block";document.getElementById("lTablePassErrorMes").innerHTML=jQuery.i18n.prop("lPassErrorMes");document.getElementById("txtReAccountPassword").value=""}else{document.getElementById("lTablePassErrorMes").style.display="none";if(isValidAccountPage()){document.getElementById("lTablePassErrorMes").style.display="none";g_objContent.postAccountItem(0,false,AccountName,AccountPassword,AccountAuthority)}}}function btnCancelClickedAccountEdit(){hm()};
